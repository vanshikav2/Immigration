---
title: "Cap On Student Visas in Canada Show Significant GDP Loss"
subtitle: "House Price Index To Take A Hit"
author: 
  - Vanshika Vanshika
thanks: "Code and data are available at: https://github.com/vanshikav2/Immigration."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
header-includes:
  - \usepackage{amsmath}
  - \usepackage{amssymb}
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(dplyr)
library(readxl)
library(here)
library(reshape2)
library(plotly)

consumption <- read.csv(here("data/analysis_data/consumption.csv"))
merged_data <- read.csv(here("data/analysis_data/merged_data.csv"))
inflation <- read.csv(here("data/analysis_data/inflation.csv"))
gdp <- read.csv(here("data/analysis_data/gdp.csv"))
revenue <- read.csv(here("data/analysis_data/revenue.csv"))
house_price_index <- read.csv(here("data/analysis_data/house_price_index.csv"))
unemployment <- read.csv(here("data/analysis_data/unemployment.csv"))
ex_and_imp <- read.csv(here("data/analysis_data/ex_and_imp.csv"))

```


# Introduction

After the COVID-19 pandemic, Canada's economy has recovered quickly, thanks to the government's help and smart planning. But, even with this improvement, there are still big challenges. For one, prices for a lot of things are going up around the world, which makes living more expensive. Also, even though lots of people have jobs (unemployment is very low), there are still many jobs no one is filling. This is good because it shows the economy is bouncing back, but it also points to problems that need fixing, like how expensive it is to live because of rising prices and issues that affect people's well-being, like stress and mental health concerns.
Additionally, Canada's welcoming attitude towards international students, who come here for education and can work after graduating, has had an unexpected side effect. It's made finding a place to live harder and more expensive, especially because there are not enough places for everyone to rent. Rent prices went up by 7.7% in just one year across the country. This highlights a big problem with not having enough affordable houses for everyone.
((https://www.reuters.com/world/americas/why-is-canada-capping-foreign-students-who-will-be-impacted-2024-01-22/)
The Canadian government, in response to these complex challenges, has initiated a policy intervention by imposing a two-year cap on the number of international students, a move that seeks to balance the educational sector's integrity with economic and housing market stability. This measure aims to relax the strain on housing problems and address concerns regarding the quality of education in an environment where certain educational institutions might not meet the expected standards. This policy change is significant, considering that international students have historically contributed substantially to the Canadian economy, with more than 1 million students contributing approximately C$22 billion annually.(https://www.bnnbloomberg.ca/student-visa-cap-to-hurt-economy-have-marginal-impact-on-housing-experts-warn-1.2025552) The cap, set at 350,000 students, alongside targeted closures in the private education sector, represents a pivotal moment in Canada's educational and immigration policy landscape.(https://economictimes.indiatimes.com/nri/study/canadas-cap-on-foreign-students-what-you-need-to-know-and-how-to-improve-your-odds-of-qualifying/articleshow/107250609.cms?from=mdr)


This report looks at how Canada is doing economically after the pandemic, focusing on how recent government decisions are helping or hurting the country's economy and prices. It talks about the good and bad sides of Canada's economic recovery, especially problems like expensive housing and rising prices caused by many international students coming to Canada. The study will predict what might happen because of government actions, like limiting the number of international students, and how these actions could affect the country's economy and prices. The estimand of the paper is GDP and inflation of 2024 after the cap on student visas.

The report also dives into the social and economic factors that are shaping Canada's future, like the situation where there are many jobs but not enough people to fill them, leading to higher wages and concerns about how productive workers are. It looks at how global trends in rising prices are making life more expensive in Canada and evaluates how well government actions are working to handle these issues.

By putting all this information together, the report aims to share important findings on how immigration and education policies are affecting Canada's economy after the pandemic. It offers advice on how to balance boosting the economy, making sure people are doing well, and keeping the education system strong. The ultimate goal is to suggest ways Canada can use its policies to keep the economy going strong while making sure people have a good quality of life in the days after the pandemic.

The remainder of this paper is structured as follows. @sec-data....



# Data {#sec-data}

## Data source and collection

The datasets utilized in this study were sourced from various reputable sources, including government agencies, statistical bureaus, and economic research institutions. The data collection process involved accessing publicly available datasets from official websites and databases, ensuring reliability and consistency across sources.


### Gross Domestic Product (GDP): 

GDP data was obtained from The World Bank of Data (https://data.worldbank.org/indicator/NY.GDP.MKTP.KD.ZG?locations=CA) which was then used, cleaned by macrotrends(https://www.macrotrends.net/global-metrics/countries/CAN/canada/gdp-gross-domestic-product). The economy's growth is quantified by changes in its output volume or the real incomes of its inhabitants. The gdp over the years can be seen in @fig-a. According to the 2008 United Nations System of National Accounts (2008 SNA), three main indicators are used to measure growth: the volume of gross domestic product (GDP), real gross domestic income, and real gross national income. GDP, a key metric, represents the total value added at constant prices by households, government, and industries operating within the economy. It encompasses all domestic production, regardless of whether the income benefits domestic or foreign entities. This dataset consisted of GDP ( Billions of US $), Per Capita (US $), and Annual % Change in GDP of Canada from 1960 - 2022. The GDP for the year 2023 was extracted separately from the World Bank of Data. 


```{r}
#| label: fig-a
#| fig-cap: Time Series Plot of GDP
#| echo: false
#| warning: false
# Time Series Plot of GDP
 ggplot(merged_data, aes(x = Year, y = GDP)) +
  geom_line(color = "red") +
  labs(x = "Year",
       y = "GDP")   +
  theme_light() +  # This adds a more visible grid compared to theme_minimal()
  theme(legend.position = "none")  # Hide legend if not necessary

# Turn it interactive with ggplotly

```


### Education Revenues: 

Revenue data was sourced from Statistics Canada(https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=3710002801). 
This dataset is about the Canadian college revenues from the year 2001 to 2022. It contains total revenue that all the canadian college made each year including grants, fees, investment, etc.  This was measured using the Financial Information of Community Colleges and Vocational Schools Survey collected by the government. The Financial Information of Community Colleges and Vocational Schools Survey was developed to provide financial information (income and expenditures) on all non-degree-granting community colleges and public vocational schools in Canada and is conducted annually.



### Housing Price Indexes: 

Housing price index data was obtained from Statistics Canada's Housing Price Index database(https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1810020501). It provides the changes in the housing price index monthly from the year 2000 to 2023. The total housing price index includes the changes in the land as well as the house price index. The New Housing Price Index (NHPI) is a monthly series that measures changes over time in the builders' selling prices of new residential houses, where detailed specifications pertaining to each house remain the same between two consecutive periods.


### Consumption: 

Consumption data was collected from Statistics Canada’s database. (https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=3610060901&pickMembers%5B0%5D=1.1&cubeTimeFrame.startYear=2008&cubeTimeFrame.endYear=2023&referencePeriods=20080101%2C20230101). It included household actual final consumption for years 2008-2023 which included their consumption on food, drinks, entertainment, housing, education, health, and all the other expenditures. This information was collected using two different surveys, The Provincial and Territorial Gross Domestic Product (GDP) by Income and by Expenditure Accounts and The National Gross Domestic Product (GDP) by Income and by Expenditure Accounts. The Provincial and Territorial Gross Domestic Product (GDP) by Income and by Expenditure Accounts program produces annual estimates of selected aggregates of the National GDP by Income and by Expenditure Accounts, by province and territory: GDP, final domestic demand, household income, and government sector accounts. Secondly, The National Gross Domestic Product (GDP) by Income and Expenditure Accounts gives a comprehensive statistical picture of Canadian economic developments. The national gross domestic product by income and by expenditure is at the center of macroeconomic analysis and policy-making in Canada. 

Some of the important features of this dataset and their trends can be seen in @fig-d.

```{r}
#| label: fig-d
#| fig-cap: "Trends of Key Variables Over Time"
#| echo: false
#| warning: false
# Line Plot of Key Variables
# Assuming 'merged_data' is your dataframe and it has the correct columns
ggplot(merged_data, aes(x = Year)) +
  geom_smooth(aes(y = Total_Unique_Persons, color = "Total Unique Persons"), se = FALSE) +
  geom_smooth(aes(y = Revenue, color = "Revenue"), se = FALSE) +
  geom_smooth(aes(y = House_Price_Index, color = "House Price Index"), se = FALSE) +
  geom_smooth(aes(y = Consumption, color = "Consumption"), se = FALSE) +
  labs(
    x = "Year",
    y = "Value",
    color = "Indicator" # Legend title
  ) +
  scale_color_manual(values = c("Total Unique Persons" = "blue", 
                                "Revenue" = "orange", 
                                "House Price Index" = "green", 
                                "Consumption" = "red")) +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() # For a clean and minimal theme
```


### Exports and Imports:

Data on exports and imports were sourced from Statistics Canada’s database(https://www150.statcan.gc.ca/n1/daily-quotidien/230509/cg-a001-eng.htm). It includes the total exports, imports, and trade balance of Canada from years 2008 to 2022. The year 2023 exports and imports were derived from the trading economics website(https://tradingeconomics.com/canada/exports#:~:text=April%20of%202024.-,Exports%20in%20Canada%20decreased%20to%2062284.80%20CAD%20Million%20in%20January,macro%20models%20and%20analysts%20expectations). 
 This is measured through the Canadian International Merchandise Trade (CIMT) Program. The objective of this statistical program is to provide measures of Canada's international merchandise trade through the production of import and export statistics. Data are extracted from administrative files.
In general, merchandise trade statistics are compiled from administrative records used by Customs agencies to facilitate and oversee the flow of goods across the frontier. 


### Unemployment Rates: 

Unemployment rate data was obtained from Macrotrends database(https://www.macrotrends.net/global-metrics/countries/CAN/canada/unemployment-rate#:~:text=Canada%20unemployment%20rate%20for%202022,a%200.17%25%20decline%20from%202018) and Statista database(https://www.statista.com/statistics/578362/unemployment-rate-canada/#:~:text=In%202023%2C%205.4%20percent%20of,force%20in%20Canada%20was%20unemployed). The data consisted of the unemployment rate in Canada and the annual change in the unemployment rate from 1991 to 2023. These rates are sourced from the International Labour Organization, “ILO Modelled Estimates and Projections database ( ILOEST ), which has surveys and automated ways of calculating the unemployment rates of the labor force. 



### Inflation: 

Inflation data was sourced from consumer price index (CPI) reports published by the World Bank of data(https://data.worldbank.org/indicator/FP.CPI.TOTL.ZG?locations=CA-XN). It measures the rate of increase in the general price level of goods and services, reflecting changes in purchasing power and overall price stability, and uses the International Monetary Fund, International Financial Statistics and data files. The inflation rate is depicted from years 1960-2023.
           Total Unique Persons in Canada: This dataset is sourced from the Government of Canada’s database(https://open.canada.ca/data/en/dataset/90115b00-f9b8-49e8-afa3-b4cff8facaee/resource/b663a97c-61d4-4e17-af51-0cba01ef3a44) which shows the Temporary Residents: Study Permit Holders of Canada from year 2000 to 2023.  This dataset is published by the  Immigration, Refugees, and Citizenship Canada. 

```{r}
#| label: fig-i
#| fig-cap: Inflation Rate over the Years
#| echo: false

# Time Series Plot of GDP
ggplot(merged_data, aes(x = Year, y = Inflation_Rate)) +
  geom_line(color = "blue") +
  labs(x = "Year",
       y = "Inflation rate") +
    theme_light() +  # This adds a more visible grid compared to theme_minimal()
  theme(legend.position = "none")  # Hide legend if not necessary

```




## Data Cleaning

We used R [@citeR] for data cleaning and processing, utilizing packages like tidyverse [@tidy] for data manipulation and janitor [@jan] for cleaning column names. Other packages used includes `ggplot2` [@ggplot], `dplyr` [@dp], `readr` [@read], `tibble` [@tib], `janitor` [@jan],`reshape2` [@reshape], `knitr` [@knit], `ggbeeswarm` [@gg], `ggrepel` [@repel], `kableExtra`[@kable], `readxl`[@readxl], `MASS`[@mass], `rstanarm`[@rstan], `modelsummary`[@model] and `here` [@here].

All these different datsets were cleaned in a different way to match the final representation of the cleaned data.

The inflation data was filtered like @tbl-cleaned-data. The original data included all the dates, so it was filtered to only include the year.
```{r}
#| label: tbl-cleaned-data
#| message: false
#| echo: false
#| warning: false
#| tbl-cap: "Sample of Inflation Rate Data"
library(kableExtra)

options(kableExtra.latex.max.width=1)
head(inflation, 6) |>
  kable(
        col.names = c("Year","Inflation_Rate","Annual_Change_Inflation"),
    booktabs = TRUE,
    longtable = FALSE
  ) %>%
  kable_styling(latex_options = c("striped", "scale_down"), font_size = 6)
```
The gdp, unemployment, college income datasets were also cleaned similarily like inflation dataset.


The consumption cleaned dataset looked like this @tbl-cleaned-data2. The data transposed to have years and consumption have vertical columns instead of horizontal. Only the Year and consumption column of the original dataset were kept and the rest were deleted. Some of the unnecessary first and last rows were also removed from the dataset.

```{r}
#| label: tbl-cleaned-data2
#| message: false
#| echo: false
#| warning: false
#| tbl-cap: "Sample of Consumption Data"
library(kableExtra)

options(kableExtra.latex.max.width=1)
head(consumption, 6) |>
  kable(
        col.names = c("", "Year","Consumption"),
    booktabs = TRUE,
    longtable = FALSE
  ) %>%
  kable_styling(latex_options = c("striped", "scale_down"), font_size = 6)
```
Some of the other datasets like exports and imports, house_price_index and revenue were also cleaned like the consumption dataset.

## Data modification
All of the datasets that were cleaned were then combined into one file as the merged.csv file shown in @tbl-cleaned-data1 It ranged from 2001 to 2023 and assigned 0 as the value for the variables that did have the value recorded for the particular year. Some of the variables such that the house price index, GDP, Revenue, and consumption were recorded horizontally and had to be transposed to fit all the data together. GDP was recorded in billions and revenue was recorded in thousands; they were converted to millions so that the entire dataset was made in the same unit of millions. The year 2023 had a lot of missing variables and were collected separately from different websites to fill the training data better.

```{r}
#| label: tbl-cleaned-data1
#| message: false
#| echo: false
#| warning: false
#| tbl-cap: "Sample of Cleaned State Score Data"
library(kableExtra)

library(knitr)
library(kableExtra)

head(merged_data, 6) %>%
  kable(
    col.names = c("Year","Total_Unique_Persons","GDP","Per_Capita","Annual_Change_GDP","Revenue","House_Price_Index","Consumption","Trade_Balance","Exports","Imports","Unemployment_rate","Annual_Change_unemployment","Inflation_Rate","Annual_Change_Inflation"),
    format = "latex",
    booktabs = TRUE,
    longtable = FALSE
  ) %>%
  kable_styling(latex_options = "scale_down", full_width = F)
```

```{r}
#| label: fig-f
#| fig-cap: Bills of penguins
#| echo: false

ggplot(merged_data, aes(x = Year)) +
  geom_line(aes(y = Unemployment_rate), color = "blue") +
  geom_line(aes(y = Inflation_Rate), color = "red") +
  labs(title = "Time Series Plot of Unemployment Rate and Inflation Rate",
       x = "Year",
       y = "Rate")

```


# Model

# Model 1
The goal of our modeling strategy is to analyze the relationship between various economic indicators and the Gross Domestic Product (GDP) of Canada.

## Model set-up

Let's define the following variables:

- $y_i$: GDP for the $i$-th year
- $x_{1i}$: Total\_Unique\_Persons for the $i$-th year
- $x_{2i}$: Revenue for the $i$-th year
- $x_{3i}$: House\_Price\_Index for the $i$-th year
- $x_{4i}$: Consumption for the $i$-th year
- $x_{5i}$: Exports for the $i$-th year
- $x_{6i}$: Unemployment\_rate for the $i$-th year
- $x_{7i}$: Inflation\_Rate for the $i$-th year

We assume that the GDP $y_i$ for each year $i$ follows a normal distribution with mean $\mu_i$ and standard deviation $\sigma$, where:


\
\begin{align*}
y_i | \mu_i, \sigma &\sim \text{Normal}(\mu_i, \sigma^2) \\
\mu_i &= \alpha + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + \beta_4 x_{4i} + \beta_5 x_{5i} + \beta_6 x_{6i} + \beta_7 x_{7i} \\
\alpha &\sim \text{Normal}(0, 2.5^2) \\
\beta_1, \beta_2, \beta_3, \beta_4, \beta_5, \beta_6, \beta_7 &\sim \text{Normal}(0, 2.5^2) \\
\sigma &\sim \text{Exponential}(1)
\end{align*}
\

We use the `rstanarm` package in R to fit the Bayesian generalized linear model.

## Model justification

We expect that changes in Total_Unique_Persons, Revenue, House_Price_Index, Consumption, Exports, Unemployment_rate, and Inflation_Rate will have an impact on the Gross Domestic Product (GDP) of Canada. Specifically, we anticipate a positive relationship between GDP and Total_Unique_Persons, Revenue, House_Price_Index, Consumption, and Exports, and a negative relationship between GDP and Unemployment_rate and Inflation_Rate. These relationships are hypothesized based on economic theory and empirical evidence.


# Model 2

The goal of this modeling strategy is to analyze the relationship between various economic indicators and the inflation rate in Canada.

## Model set-up

Let's define the following variables:

- $y_i$: Inflation\_Rate for the $i$-th year
- $x_{1i}$: Total\_Unique\_Persons for the $i$-th year
- $x_{2i}$: GDP for the $i$-th year
- $x_{3i}$: Annual\_Change\_GDP for the $i$-th year
- $x_{4i}$: Revenue for the $i$-th year
- $x_{5i}$: House\_Price\_Index for the $i$-th year
- $x_{6i}$: Consumption for the $i$-th year
- $x_{7i}$: Exports for the $i$-th year
- $x_{8i}$: Unemployment\_rate for the $i$-th year

We assume that the Inflation\_Rate $y_i$ for each year $i$ follows a normal distribution with mean $\mu_i$ and standard deviation $\sigma$, where:

\
\begin{align*}
y_i | \mu_i, \sigma &\sim \text{Normal}(\mu_i, \sigma^2) \\
\mu_i &= \alpha + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + \beta_4 x_{4i} + \beta_5 x_{5i} + \beta_6 x_{6i} + \beta_7 x_{7i} + \beta_8 x_{8i} \\
\alpha &\sim \text{Normal}(0, 2.5^2) \\
\beta_1, \beta_2, \beta_3, \beta_4, \beta_5, \beta_6, \beta_7, \beta_8 &\sim \text{Normal}(0, 2.5^2) \\
\sigma &\sim \text{Exponential}(1)
\end{align*}
\

We use the `stan_glm` function in R to fit the Bayesian generalized linear model.

## Model justification

We expect that changes in Total_Unique_Persons, GDP, Annual_Change_GDP, Revenue, House_Price_Index, Consumption, Exports, and Unemployment_rate will have an impact on the inflation rate in Canada. Specifically, we anticipate a positive relationship between inflation rate and Total_Unique_Persons, GDP, Revenue, House_Price_Index, Consumption, and Exports, and a negative relationship between inflation rate and Unemployment_rate. These relationships are hypothesized based on economic theory and empirical evidence.

# Results
In this study, we sought to identify the factors that significantly contribute to the Gross Domestic Product (GDP) and Inflation Rate. We applied a Bayesian generalized linear model to a dataset encompassing a range of economic indicators over a period of years.


```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

library(rstanarm)

gdp_model <-
  readRDS(file = here::here("models/gdp_model.rds"))

inflation_model <-
  readRDS(file = here::here("models/inflation_model.rds"))

```

```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
#| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

modelsummary::modelsummary(
  list(
    "GDP model" = gdp_model
  ),
  statistic = "mad",
  fmt = 2
)
```
```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresultss
#| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false


modelsummary::modelsummary(
  list(
    "Inflation model" = inflation_model
  ),
  statistic = "mad",
  fmt = 2
)
```


## Model Summary 
Our GDP model results are summarized in @tbl-modelresults. The Bayesian regression model revealed several key economic indicators that were significantly associated with GDP. The estimated coefficients from the model indicate the direction and magnitude of each variable's effect. Notable factors with positive influence include Total_Unique_Persons, suggesting that population growth positively correlates with GDP. Similarly, Annual_Change_GDP, Revenue, House_Price_Index, and Consumption all positively impact GDP. On the contrary, Exports showed a slightly negative association, which needs further investigation into the nature of exports and their economic value.

The model demonstrates an excellent fit with an R-squared value of 0.929, indicating that approximately 92.9% of the variance in GDP is explained by the included predictors (See Table 1). The adjusted R-squared, which accounts for the number of predictors in the model, is slightly lower at 0.918, affirming the robustness of the model. The Root Mean Square Error (RMSE) of 117581.47 provides an estimate of the model's prediction error. 


Our Inflation model results are summarized in @tbl-modelresultss. The coefficient for Annual_Change_GDP is 0.13 with a standard error of 0.12, suggesting a possible positive relationship with inflation, though this effect is not statistically significant since the coefficient is less than twice its standard error.
House_Price_Index has a coefficient of -0.01 with a standard error of 0.05, indicating a minor and statistically non-significant negative relationship with inflation.
Unemployment_rate has a coefficient of -0.03 with a standard error of 0.27, indicating a slight negative relationship with inflation, but again this is not statistically significant.
All other variables, including Total_Unique_Persons, GDP, Revenue, Consumption, and Exports, have coefficients of 0.00, which means they have no identified relationship with inflation based on this model.

The Root Mean Square Error (RMSE) of 0.70 is relatively low, suggesting that the model's predictions are, on average, close to the observed values. However, the RMSE must be contextualized within the scale of the inflation rate to assess its practical significance.




## GDP Coefficient Plot Summary:
The plot @fig-modelresultsss indicates that none of the predictors show a statistically significant impact on the dependent variable, as the confidence intervals for all coefficients include zero. Notably, Annual_Change_GDP, Unemployment_rate, and Inflation_Rate have the most substantial effects among the predictors, with Annual_Change_GDP showing a potentially positive effect and the latter two showing negative effects. The sigma parameter is significantly different from zero, confirming the presence of variability in the model's residuals.
```{r}
#| echo: false
#| eval: true
#| label: fig-modelresultsss
#| fig-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

# Generate plots for GDP model
gdp_plot <- plot(gdp_model)

gdp_plot

new_data1 <- data.frame(
  Total_Unique_Persons = 360000, # Cap on Total_Unique_Persons
  Annual_Change_GDP = 1.5000,
  Revenue = 13971.575,
  House_Price_Index = 124.4,
  Consumption = 63372.4,
  Exports = 779216,
  Unemployment_rate = 5.400,
  Inflation_Rate = 3.6200 # Adjusted variable name without line continuation
)

predicted_gdp <- predict(gdp_model, newdata = new_data1)




```
## Inflation Coefficient Plot Summary:
Similar to the first, @fig-modelresultssss plot also suggests that none of the variables provide a statistically significant prediction of the dependent variable, given that all confidence intervals encompass zero. The predictors' coefficients are centered even closer to zero compared to the first plot, indicating an even less pronounced effect. Annual_Change_GDP has a coefficient that is slightly above zero but still not statistically significant. There is no Inflation_Rate variable present in this model, which may suggest a different model focus or specification.

```{r}
#| echo: false
#| eval: true
#| label: fig-modelresultssss
#| fig-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

# Generate plots for inflation model
inflation_plot <- plot(inflation_model)
inflation_plot

new_data <- data.frame(
  Total_Unique_Persons = 360000, # Cap on Total_Unique_Persons
  GDP = 2910986,
  Annual_Change_GDP = 1.5000,
  Revenue = 13971.575,
  House_Price_Index = 124.4,
  Consumption = 63372.4,
  Exports = 779216,
  Unemployment_rate = 5.400
  
)
predicted_inflation <- predict(inflation_model, newdata = new_data)

```

```{r}
#| echo: false
#| eval: true
#| label: fig-graph5
#| fig-cap: "Regression Relation Between House Price Index and Student Population"
#| warning: false


# Plotting the regression graph
ggplot(merged_data, aes(x = Total_Unique_Persons, y = Unemployment_rate)) +
  geom_point() +  # Add points
    geom_point(alpha = 0.5) +  # Add scatter points
  scale_x_log10() + 
  geom_smooth(method = "lm", se = FALSE, color = "blue") +  # Add regression line
  labs(title = "",
       x = "Total Student Visas", y = "House Price Index") +
  theme_minimal()



```


## Predictions
Using the model we created and trained, we predicted the GDP of Canada for 2024 given the economical constraints of 2024 as seen in @fig-prediction. The predicted GDP for the given data is: `r predicted_gdp`
```{r}
#| echo: false
#| eval: true
#| label: fig-prediction
#| fig-cap: "Predicted GDP for the Next Year along with Previous Years' Values"
#| warning: false
#| 
new_data1 <- data.frame(
  Total_Unique_Persons = 360000, # Cap on Total_Unique_Persons
  Annual_Change_GDP = 1.5000,
  Revenue = 13971.575,
  House_Price_Index = 124.4,
  Consumption = 63372.4,
  Exports = 779216,
  Unemployment_rate = 5.400,
  Inflation_Rate = 3.6200 # Adjusted variable name without line continuation
)

predicted_gdp <- predict(gdp_model, newdata = new_data1)



# Combine the predicted GDP value with the previous years' GDP values
all_years_gdp <- c(merged_data$GDP, predicted_gdp)

# Create a vector of years including the next year
all_years <- c(merged_data$Year, max(merged_data$Year) + 1)
# Create a data frame for plotting
plot_data <- data.frame(Year = all_years, GDP = all_years_gdp)

# Plot the combined data using ggplot2
ggplot(plot_data, aes(x = Year, y = GDP)) +
  geom_line() +
  geom_point(aes(color = ifelse(Year == 2024, "red", "blue")), size = 3) +
  labs(
       x = "Year", y = "GDP") +
  theme_minimal()  +
   scale_x_continuous(breaks = seq(min(all_years), max(all_years), by = 1)) +
  scale_color_identity(guide = "none") +  # Hide the color legend 
   theme(axis.text.x = element_text(angle = 90, vjust = 0.5))



```

As seen, the GDP decreases quite drastically given the number of fewer students entering the country. 

It is anticipated that the economy's supply and demand sides will be impacted by population loss. Generally speaking, a decline in population indicates a decrease in the labour supply (since the population is the source of labour) and a decrease in the labour input used in production; on the demand side, it indicates a decrease in the demand for housing, consumption goods and services, and investment because these items are demanded by people. It is anticipated that these adjustments will eventually cause the gross domestic product to decline.(https://www.nature.com/articles/s41599-023-02223-7)

The @fig-graph1 shows the relationship between increasing GDP and house price index of Canada. This shows that as the GDP grows, the house price index of the country also increases as the linear relationship between these variables is very direct. This relationship means that any change in the GDP of the country would have an effect on the housing market as well. As the government places a cap on the student population entering the country and the GDP decreases, this entails the house price index to decrease as well. As quoted by __, "Rising house prices have a positive impact on real GDP through the consumption effect and the construction of new houses (housing investment). Basically, the strength of this positive effect relies on a large share of homeowners (especially regarding the consumption effect)." (https://typeset.io/papers/search-frictions-housing-prices-and-growth-2w5hf4izya)

```{r}
#| echo: false
#| eval: true
#| label: fig-graph1
#| fig-cap: "Regression Plot: GDP vs. House Price Index"
#| warning: false

# Plotting the regression graph
ggplot(merged_data, aes(x = GDP, y = House_Price_Index)) +
  geom_point() +  # Add points
  geom_smooth(method = "lm", se = FALSE, color = "blue") +  # Add regression line
  labs(
       x = "GDP", y = "House Price Index") +
  theme_minimal()

```


This brings us to the second point about the effect that lower number of homeowners have on the housing market of the country. With the cap induced, there are smaller number of people entering the country and  contributing to the GDP of the country. The decline in the GDP contributes to the decline in the housing market prices which makes the house price index decrease as well and this can be seen in @fig-graph2. As
Gerrard Flitti added that population decline would "absolutely" have negative economic impacts in the long term, with labor shortages leading to a decrease in GDP, inflation, and recession. "It just basically sinks the economy for years to come unless there's a massive increase in productivity," Filitti  said.(https://www.foxbusiness.com/media/impending-us-population-decline-could-lead-another-depression-more-inflation-experts)


```{r}
#| echo: false
#| eval: true
#| label: fig-graph2
#| fig-cap: "Regression Relation Between House Price Index and Student Population"
#| warning: false


# Plotting the regression graph
ggplot(merged_data, aes(x = Total_Unique_Persons, y = House_Price_Index)) +
  geom_point() +  # Add points
    geom_point(alpha = 0.5) +  # Add scatter points
  scale_x_log10() + 
  geom_smooth(method = "lm", se = FALSE, color = "blue") +  # Add regression line
  labs(title = "",
       x = "Total Student Visas", y = "House Price Index") +
  theme_minimal()

```

The other aspect of the economic analysis for this study was the effect on inflation caused by the change in student visa numbers. The @fig-prediction1 shows the predicted inflation rate for 2024 to be `r predicted_inflation`. A decreasing population can lead to a shortage of labor, which in turn can drive up wages as employers compete for a smaller pool of workers. Higher wages can lead to higher production costs for goods and services, potentially causing cost-push inflation. This can be used to explain the extremely high inflation for 2024 being predicted. This notation can be seen in other countries like the US.  For instance, the Federal Reserve Bank of Atlanta points out that population aging is a significant factor contributing to labor shortages in the United States, which, in turn, has been fueling inflation. Since 2019, there's been a notable increase in the population of those aged 65 and older, while the population of prime-age workers (ages 25 to 54) has barely changed. This demographic shift towards an older population has led to a tighter labor market, as there are fewer younger people entering the workforce to replace retiring workers. Such a scenario can lead to wage inflation as employers compete for a smaller pool of workers, ultimately driving up production costs and contributing to cost-push inflation(https://www.atlantafed.org/economy-matters/economic-research/2023/01/12/we-re-getting-older-and-the-labor-market-shows-it). With a decrease of young population entering the labour force of Canada, the country can expect to experience a cost-push inflation.


```{r}
#| echo: false
#| eval: true
#| label: fig-prediction1
#| fig-cap: "Predicted Inflation Rate for the Next Year along with Previous Years' Values"
#| warning: false

new_data <- data.frame(
  Total_Unique_Persons = 360000, # Cap on Total_Unique_Persons
  GDP = 2910986,
  Annual_Change_GDP = 1.5000,
  Revenue = 13971.575,
  House_Price_Index = 124.4,
  Consumption = 63372.4,
  Exports = 779216,
  Unemployment_rate = 5.400
  
)
predicted_inflation <- predict(inflation_model, newdata = new_data)

# Combine the predicted inflation value with the previous years' inflation values
all_years_inflation <- c(merged_data$Inflation_Rate, predicted_inflation)

# Create a data frame for plotting
plot_data_inflation <- data.frame(Year = all_years, Inflation_Rate = all_years_inflation)

# Plot the combined data using ggplot2
ggplot(plot_data_inflation, aes(x = Year, y = Inflation_Rate)) +
  geom_line() +
  geom_point(aes(color = ifelse(Year == 2024, "red", "blue")), size = 3) +  # Change color for 2024 year dot
 
  labs(
       x = "", y = "Inflation Rate") +  # Remove x-axis label
  scale_color_identity(guide = "none") +  # Hide the color legend
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))  + # Rotate x-axis labels vertically
   scale_x_continuous(breaks = seq(min(all_years), max(all_years), by = 1)) 

```


# Discussion

## Weaknesses and next steps

The dataset used in this analysis may be subject to various biases, which could affect the validity and generalizability of the findings. There is measurement bias in the dataset from inaccuracies or inconsistencies in data collection methods, such as self-reporting or sampling errors. The dataset also a collection of different datasets with different units of measurements and converting them into one unit dataset arises measurement bias. Also alot of values of different years were missing for different variables of the dataset that were sourced from other datasets and websites, which creates biases. Furthermore, the analysis process itself is susceptible to weaknesses such as model assumptions, variable selection bias, and overfitting. Model assumptions may not be met by the data, leading to biased estimates or incorrect conclusions. Variable selection bias could influence results depending on which variables are included or excluded from the analysis. Overfitting may occur if complex models fit the training data too closely but generalize poorly to new data. These weaknesses highlight the importance of careful consideration and transparency throughout the research process to mitigate biases and ensure the reliability of the findings.


In future research, it would be beneficial to address several avenues for further exploration and refinement. Firstly, expanding the dataset to include additional relevant variables could enhance the depth of the analysis and provide a better understanding of the factors influencing economic indicators. Additionally, conducting longitudinal studies to track changes over time and incorporating dynamic modeling techniques could offer insights into the evolving nature of economic relationships. Furthermore, considering the impact of external factors such as policy interventions, socio-economic trends, and global events on the studied phenomena could enrich the analysis and provide valuable insights for policymakers and practitioners. Overall, this cap of 360,000 on international students for two years is a big step taken by the governnment and its economic effects need to studied furthur to help decrease possible losses in different sector of  the economy.

\newpage

\appendix

# Appendix {-}


# Additional data details

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows the fit between the observed GDP data and the data simulated from the model's posterior distribution. The x-axis likely represents the GDP values, while the y-axis indicates the density of these values within the data. It appears that the model has varying success in capturing the distribution of the observed GDP. The central mass of the predictive simulations (represented by the numerous blue lines) seems to align well with the peak of the observed data (the solid black line), suggesting that the model accurately captures the median of the GDP data.

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows the model's predictions are consistent with the observed data. The tail behavior and the central peak of the observed data distribution are captured within the range of the simulations, although there might be some discrepancies at the peak.

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]

pp_check(gdp_model) +
  theme_classic() +
  theme(legend.position = "bottom")


pp_check(inflation_model) +
  theme_classic() +
  theme(legend.position = "bottom")


```



\newpage


# References


